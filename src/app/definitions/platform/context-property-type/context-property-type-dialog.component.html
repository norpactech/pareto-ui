<div class="dialog-scroll-container">
  <h2 mat-dialog-title>
    <span *ngIf="formGroup?.get('contextName')?.value as contextName">
      {{ contextName }}
    </span>
    Context Data Type Details
  </h2>
  <mat-divider></mat-divider>
  <mat-card class="context-card">
    <mat-card-content>
      <form [formGroup]="formGroup" (ngSubmit)="submit()">
        <!-- Description Section (full width) -->
        <mat-divider></mat-divider>

        <div class="form-row">
          <mat-form-field appearance="fill">
            <mat-label>Schema</mat-label>
            <mat-select formControlName="idSchema" required>
              <mat-option *ngFor="let type of schemaList" [value]="type.id">
                {{ type.name }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="formGroup.get('idSchema')?.hasError('required')">
              Schema is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>Context Value</mat-label>
            <mat-select formControlName="idContext" required>
              <mat-option *ngFor="let type of contextList" [value]="type.id">
                {{ type.name }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="formGroup.get('idContext')?.hasError('required')">
              Context is required
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="fill">
            <mat-label>Generic Property Type</mat-label>
            <mat-select formControlName="idGenericPropertyType" required>
              <mat-option *ngFor="let type of genericPropertyTypeList" [value]="type.id">
                {{ type.name }}
              </mat-option>
            </mat-select>
            <mat-error
              *ngIf="formGroup.get('idGenericPropertyType')?.hasError('required')">
              Generic Property Type is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>Scale</mat-label>
            <input matInput formControlName="scale" />
            <mat-error *ngIf="formGroup.get('scale')?.hasError('required')">
              Scale is required
            </mat-error>
          </mat-form-field>
        </div>

        <!-- Is Nullable -->
        <mat-form-field appearance="fill">
          <mat-label>Is Nullable</mat-label>
          <mat-select formControlName="isNullable">
            <mat-option [value]="true">True</mat-option>
            <mat-option [value]="false">False</mat-option>
          </mat-select>
          <mat-error *ngIf="formGroup.get('isNullable')?.hasError('required')">
            Is Nullable is required
          </mat-error>
        </mat-form-field>

        <!-- Default Value -->
        <mat-form-field appearance="fill">
          <mat-label>Default Value</mat-label>
          <input matInput formControlName="defaultValue" />
          <mat-error *ngIf="formGroup.get('defaultValue')?.hasError('required')">
            Default Value is required
          </mat-error>
        </mat-form-field>

        <div class="blank-line"></div>
        <mat-divider></mat-divider>
        <div class="blank-line"></div>

        <!-- Form Updates -->
        <mat-card *ngIf="formGroup.get('id')?.value" class="audit-card">
          <mat-card-content>
            <!-- Is Active -->
            <div
              fxLayout="row"
              fxLayout.lt-sm="column"
              fxLayoutGap="8px"
              class="form-row">
              <mat-checkbox formControlName="isActive" fxFlex="50%" color="primary">
                Is Active
              </mat-checkbox>
            </div>

            <div class="blank-line"></div>
            <mat-divider></mat-divider>
            <div class="blank-line"></div>

            <!-- Audit Fields -->
            <div
              fxLayout="row"
              fxLayout.lt-sm="column"
              fxLayoutGap="8px"
              class="form-row">
              <div fxFlex="30%">
                <span class="mono-font">Created By:</span>&nbsp;
                <span class="mono-font">{{ formGroup.get('createdBy')?.value }}</span
                >&nbsp;
              </div>
              <div fxFlex="70%">
                <span class="mono-font">Created At:</span>&nbsp;
                <span class="mono-font">{{
                  formGroup.get('createdAt')?.value | date: 'yyyy-MM-dd h:mm a z'
                }}</span>
              </div>
            </div>
            <div
              fxLayout="row"
              fxLayout.lt-sm="column"
              fxLayoutGap="8px"
              class="form-row">
              <div fxFlex="30%">
                <span class="mono-font">Updated By:</span>&nbsp;
                <span class="mono-font">{{ formGroup.get('updatedBy')?.value }}</span
                >&nbsp;
              </div>
              <div fxFlex="70%">
                <span class="mono-font">Updated At:</span>&nbsp;
                <span class="mono-font">{{
                  formGroup.get('updatedAt')?.value | date: 'yyyy-MM-dd h:mm a z'
                }}</span>
              </div>
            </div>
          </mat-card-content>
        </mat-card>

        <!-- Actions Section -->
        <div class="blank-line"></div>
        <mat-divider></mat-divider>
        <div class="blank-line"></div>
        <!-- Form content -->
        <div
          fxLayout="row"
          fxLayoutAlign="end center"
          fxLayoutGap="8px"
          class="form-actions">
          <button mat-raised-button mat-dialog-close>Cancel</button>
          <button mat-raised-button color="warn" type="button" (click)="confirmDelete()">
            Delete
          </button>
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="formGroup.invalid">
            Save
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
